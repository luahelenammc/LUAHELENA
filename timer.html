<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <title>Flip Clock - Contador Horizontal com URL Sync</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", Arial, sans-serif;
      font-variant-numeric: tabular-nums lining-nums;
      background:
        radial-gradient(1400px 700px at 50% -10%, #1b1f25 0%, #101317 55%, #0b0d10 100%),
        #0e1116;
      color: #e6e9ef;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 1.6rem;
      padding: 2rem;
    }

    /* Atalhos */
    .quick-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: .6rem .6rem;
      justify-content: center;
      filter: drop-shadow(0 4px 14px rgba(0,0,0,.35));
    }
    .quick-buttons button {
      cursor: pointer;
      border: none;
      padding: .55rem .8rem;
      border-radius: 999px;
      background: linear-gradient(#f5f7fa, #cfd6df);
      color: #0e1116;
      font-weight: 700;
      letter-spacing: .01em;
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,.65),
        inset 0 -1px 0 rgba(0,0,0,.15),
        0 6px 18px rgba(0,0,0,.35);
      transition: transform .06s ease, filter .12s ease;
      white-space: nowrap;
    }
    .quick-buttons button:active { transform: translateY(1px); filter: brightness(.96); }

    /* Input + bot√£o iniciar */
    .input-container {
      display: flex;
      gap: 0.6rem;
      align-items: center;
      flex-wrap: wrap;
      filter: drop-shadow(0 4px 14px rgba(0,0,0,.45));
    }
    .input-container input[type="datetime-local"] {
      appearance: none;
      border: none;
      outline: none;
      padding: .6rem .8rem;
      font-size: 0.95rem;
      border-radius: 10px;
      background: linear-gradient(#2a2f37, #22262d);
      color: #f3f5f7;
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,.08),
        inset 0 -1px 0 rgba(0,0,0,.35),
        0 6px 18px rgba(0,0,0,.35);
    }
    .input-container button {
      cursor: pointer;
      border: none;
      padding: .6rem 1rem;
      font-weight: 700;
      letter-spacing: .02em;
      border-radius: 10px;
      color: #0e1116;
      background: linear-gradient(#f5f7fa, #cfd6df);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,.7),
        inset 0 -1px 0 rgba(0,0,0,.15),
        0 8px 20px rgba(0,0,0,.35);
      transition: transform .06s ease, filter .12s ease;
    }
    .input-container button:active { transform: translateY(1px); filter: brightness(.96); }

    /* Layout em linhas */
    .clock-rows {
      display: grid;
      grid-template-rows: auto auto auto;
      gap: 0.9rem;
      perspective: 1200px;
    }
    .row {
      display: flex;
      gap: 1.1rem;
      flex-wrap: wrap;
      align-items: flex-start;
      justify-content: center;
    }

    /* Grupo: cart√£o √† esquerda, legenda √† direita */
    .digit-group {
      display: inline-flex;
      align-items: center;
      gap: .5rem;
      user-select: none;
    }
    .group-label {
      font-size: 0.8rem;
      letter-spacing: .11em;
      text-transform: uppercase;
      color: #9aa3af;
      margin-top: .15rem;
      min-width: 3ch;
      text-align: left; /* legenda √† direita do cart√£o */
    }

    /* Cart√£o f√≠sico do d√≠gito */
    .digit {
      width: 110px;
      height: 140px;
      perspective: 1000px;
      position: relative;
      border-radius: 14px;
      filter: drop-shadow(0 16px 30px rgba(0,0,0,.55));
    }
    .digit::before {
      content: "";
      position: absolute;
      inset: -6px;
      border-radius: 18px;
      background:
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,0) 28%, rgba(0,0,0,.35) 100%);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,.06),
        0 2px 6px rgba(0,0,0,.4);
      pointer-events: none;
    }
    .flip-container {
      width: 100%; height: 100%;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 460ms cubic-bezier(.22,.61,.36,1);
      will-change: transform;
      border-radius: 14px;
      overflow: hidden;
    }
    .flip-front,
    .flip-back {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3.25rem;
      font-weight: 800;
      letter-spacing: .02em;
      color: #e8eaee;
      text-shadow:
        0 1px 0 rgba(0,0,0,.65),
        0 2px 8px rgba(0,0,0,.35);
      backface-visibility: hidden;
      background:
        radial-gradient(120% 100% at 50% 0%, rgba(255,255,255,.04), rgba(255,255,255,0) 60%),
        linear-gradient(180deg, #1a1f25 0%, #14181d 52%, #101419 100%),
        repeating-linear-gradient(90deg, rgba(255,255,255,.025) 0 2px, rgba(255,255,255,0) 2px 4px);
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.04);
      box-shadow:
        inset 0 14px 28px rgba(255,255,255,.04),
        inset 0 -18px 38px rgba(0,0,0,.55),
        inset 0 0 0 1px rgba(0,0,0,.6);
    }
    .flip-front::before,
    .flip-back::before {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: 14px;
      background:
        linear-gradient(180deg, transparent calc(50% - 1px), rgba(255,255,255,.09) calc(50% - 1px), rgba(0,0,0,.55) 50%, transparent calc(50% + 2px)),
        radial-gradient(8px 8px at 12px 12px, rgba(255,255,255,.35), rgba(255,255,255,0) 70%),
        radial-gradient(8px 8px at calc(100% - 12px) 12px, rgba(255,255,255,.35), rgba(255,255,255,0) 70%),
        radial-gradient(8px 8px at 12px calc(100% - 12px), rgba(255,255,255,.35), rgba(255,255,255,0) 70%),
        radial-gradient(8px 8px at calc(100% - 12px) calc(100% - 12px), rgba(255,255,255,.35), rgba(255,255,255,0) 70%);
      pointer-events: none;
    }
    .flip-front::after,
    .flip-back::after {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: 14px;
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,0) 28%);
      mix-blend-mode: screen;
      pointer-events: none;
    }
    .flip-back { transform: rotateX(180deg); }
    .digit.flipped .flip-container { transform: rotateX(180deg); }

    /* Grupos opcionais (anos/meses/dias) inicialmente ocultos */
    #yearGroup, #monthGroup, #dayGroup { display: none; }

    /* Responsivo */
    @media (max-width: 1100px) { .digit { width: 96px; height: 122px; } .flip-front, .flip-back { font-size: 2.8rem; } }
    @media (max-width: 880px)  { .digit { width: 86px; height: 110px; } .flip-front, .flip-back { font-size: 2.4rem; } }
    @media (max-width: 768px)  { .clock-rows { transform: scale(.95); transform-origin: top center; } }
    @media (max-width: 560px)  { .clock-rows { transform: scale(.86); } }
    @media (max-width: 460px)  { .clock-rows { transform: scale(.78); } }
  </style>
</head>
<body>
  <!-- Bot√µes r√°pidos -->
  <div class="quick-buttons">
    <button onclick="quickSet('2025-09-18T07:00')">ü©∫ Cirurgia CRS</button>
    <button onclick="quickSet('2024-06-01T22:00')">üé≠ Transi√ß√£o Social</button>
    <button onclick="quickSet('2024-09-06T21:00')">üß¨ Transi√ß√£o Hormonal</button>
    <button onclick="quickSet('2023-10-02T08:00')">üè• Tempo de Medical</button>
  </div>

  <!-- Input manual -->
  <div class="input-container">
    <input type="datetime-local" id="targetDatetime" />
    <button onclick="startCountdown()">Iniciar Contador</button>
  </div>

  <!-- Linhas do rel√≥gio -->
  <div class="clock-rows">
    <!-- Linha 1: Anos + Meses -->
    <div class="row">
      <div class="digit-group" id="yearGroup">
        <div class="digit" id="yearValue" data-value="0">
          <div class="flip-container">
            <div class="flip-front">0</div>
            <div class="flip-back">0</div>
          </div>
        </div>
        <div class="group-label">Anos</div>
      </div>

      <div class="digit-group" id="monthGroup">
        <div class="digit" id="monthValue" data-value="0">
          <div class="flip-container">
            <div class="flip-front">0</div>
            <div class="flip-back">0</div>
          </div>
        </div>
        <div class="group-label">Meses</div>
      </div>
    </div>

    <!-- Linha 2: Dias -->
    <div class="row">
      <div class="digit-group" id="dayGroup">
        <div class="digit" id="dayValue" data-value="0">
          <div class="flip-container">
            <div class="flip-front">0</div>
            <div class="flip-back">0</div>
          </div>
        </div>
        <div class="group-label">Dias</div>
      </div>
    </div>

    <!-- Linha 3: Horas | Minutos | Segundos -->
    <div class="row">
      <div class="digit-group">
        <div class="digit" id="hourValue" data-value="00">
          <div class="flip-container">
            <div class="flip-front">00</div>
            <div class="flip-back">00</div>
          </div>
        </div>
        <div class="group-label">Horas</div>
      </div>

      <div class="digit-group">
        <div class="digit" id="minuteValue" data-value="00">
          <div class="flip-container">
            <div class="flip-front">00</div>
            <div class="flip-back">00</div>
          </div>
        </div>
        <div class="group-label">Minutos</div>
      </div>

      <div class="digit-group">
        <div class="digit" id="secondValue" data-value="00">
          <div class="flip-container">
            <div class="flip-front">00</div>
            <div class="flip-back">00</div>
          </div>
        </div>
        <div class="group-label">Segundos</div>
      </div>
    </div>
  </div>

  <script>
    function flipDigit(digitElem, newVal) {
      const oldVal = digitElem.getAttribute("data-value");
      if (String(newVal) === oldVal) return;

      const flipContainer = digitElem.querySelector(".flip-container");
      const frontElem = digitElem.querySelector(".flip-front");
      const backElem  = digitElem.querySelector(".flip-back");

      backElem.textContent  = newVal;
      frontElem.textContent = oldVal;

      digitElem.classList.add("flipped");
      setTimeout(() => {
        digitElem.classList.remove("flipped");
        frontElem.textContent = newVal;
        digitElem.setAttribute("data-value", newVal);
      }, 460);
    }

    let targetDate = null;
    let countdownInterval = null;

    function getURLParameter(name) {
      const params = new URLSearchParams(window.location.search);
      return params.get(name);
    }

    function updateURL(datetime) {
      const url = new URL(window.location);
      url.searchParams.set('datetime', datetime);
      window.history.replaceState({}, '', url);
    }

    function startCountdown() {
      const inputElem = document.getElementById("targetDatetime");
      const inputVal = inputElem.value;
      if (!inputVal) { alert("Selecione uma data e hora!"); return; }
      targetDate = new Date(inputVal);
      clearInterval(countdownInterval);
      updateURL(inputVal);
      updateCounter();
      countdownInterval = setInterval(updateCounter, 1000);
    }

    function quickSet(isoLocal) {
      // Define o input, atualiza URL e dispara o contador
      const inputElem = document.getElementById("targetDatetime");
      inputElem.value = isoLocal;
      startCountdown();
    }

    function updateCounter() {
      if (!targetDate) return;

      const now = new Date();
      let diffMs = targetDate - now;
      const isPast = diffMs < 0;
      diffMs = Math.abs(diffMs);
      const totalSeconds = Math.floor(diffMs / 1000);

      let daysTotal = Math.floor(totalSeconds / (3600 * 24));
      let remainder = totalSeconds % (3600 * 24);
      const hours = Math.floor(remainder / 3600);
      remainder %= 3600;
      const minutes = Math.floor(remainder / 60);
      const seconds = remainder % 60;

      let years  = Math.floor(daysTotal / 365);
      let restDaysAfterYears = daysTotal % 365;
      let months = Math.floor(restDaysAfterYears / 30);
      let days   = restDaysAfterYears % 30;

      const yearGroup  = document.getElementById("yearGroup");
      const monthGroup = document.getElementById("monthGroup");
      const dayGroup   = document.getElementById("dayGroup");

      yearGroup.style.display  = years  > 0 ? "inline-flex" : "none";
      monthGroup.style.display = months > 0 || years > 0 ? "inline-flex" : "none"; // mant√©m meses junto com anos
      dayGroup.style.display   = days   > 0 || months > 0 || years > 0 ? "inline-flex" : "none";

      flipDigit(document.getElementById("yearValue"),   String(years));
      flipDigit(document.getElementById("monthValue"),  String(months));
      flipDigit(document.getElementById("dayValue"),    String(days));
      flipDigit(document.getElementById("hourValue"),   String(hours).padStart(2,"0"));
      flipDigit(document.getElementById("minuteValue"), String(minutes).padStart(2,"0"));
      flipDigit(document.getElementById("secondValue"), String(seconds).padStart(2,"0"));

      document.title = isPast
        ? `J√° passou: -${years}y ${months}m ${days}d ${hours}h ${minutes}m ${seconds}s`
        : `Falta: ${years}y ${months}m ${days}d ${hours}h ${minutes}m ${seconds}s`;
    }

    function initializeFromURL() {
      const datetimeParam = getURLParameter('datetime');
      if (datetimeParam) {
        const validDate = new Date(datetimeParam);
        if (!isNaN(validDate)) {
          const inputElem = document.getElementById("targetDatetime");
          inputElem.value = datetimeParam;
          targetDate = validDate;
          updateCounter();
          countdownInterval = setInterval(updateCounter, 1000);
        }
      }
    }
    window.onload = initializeFromURL;
  </script>
</body>
</html>
