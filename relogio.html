<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Relógio — repaginado</title>
<link rel="icon" type="image/x-icon" href="/images/briefcase.png">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0b0c0f; --muted:#cfd6dc; --accent2:#00ff77; --accent1:#00ffff;
  }
  *{box-sizing:border-box}
  body{
    margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center;
    font-family:'Inter',system-ui,Segoe UI,Roboto; background:linear-gradient(180deg,#060609,#0d0f11);
    color:var(--muted); padding:28px;
  }
  .bezel{ width:760px; max-width:95vw; padding:22px; border-radius:18px;
    background:linear-gradient(180deg,#0f1316,#17191c); box-shadow:0 12px 40px rgba(0,0,0,0.7); position:relative; }
  .glass{ border-radius:12px; padding:18px; display:flex; gap:20px; align-items:center; justify-content:space-between;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.005)); backdrop-filter: blur(3px); }
  .screw{position:absolute;width:12px;height:12px;border-radius:50%;background:linear-gradient(145deg,#ddd,#888);border:1px solid rgba(0,0,0,0.2)}
  .s1{left:12px;top:12px}.s2{right:12px;top:12px}.s3{left:12px;bottom:12px}.s4{right:12px;bottom:12px}
  .chart-wrap{width:420px;min-height:420px;display:flex;align-items:center;justify-content:center;padding:8px}
  .dial{width:400px;height:400px;border-radius:50%;background:linear-gradient(180deg,#071014,#0d1114);box-shadow:inset 0 18px 40px rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center}
  canvas{display:block;border-radius:50%}
  .controls{width:280px;display:flex;flex-direction:column;gap:14px}
  .title{margin:0;font-size:20px;font-weight:600}
  .sub{margin:6px 0 0 0;font-size:12px;color:rgba(207,214,220,0.72)}
  .btn{padding:12px 16px;border-radius:12px;cursor:pointer;background:linear-gradient(180deg,#d7dbe0,#bfc6cc);box-shadow:0 6px 0 #6b6f73;border:1px solid rgba(0,0,0,0.15);font-weight:600}
  .btn.secondary{background:linear-gradient(180deg,#1a1f24,#0f1417);color:var(--muted);box-shadow:0 8px 18px rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.03)}
  .link-salario{display:inline-block;padding:10px 12px;border-radius:10px;text-decoration:none;font-weight:600;color:var(--accent1)}
  .meta{font-size:12px;color:rgba(207,214,220,0.6);display:flex;gap:8px;align-items:center}
  @media (max-width:900px){ .glass{flex-direction:column;align-items:center} .chart-wrap{width:100%} .controls{width:100%} .dial{width:320px;height:320px} }
</style>
</head>
<body>
  <div class="bezel" role="region" aria-label="painel relógio">
    <div class="screw s1" aria-hidden="true"></div><div class="screw s2" aria-hidden="true"></div>
    <div class="screw s3" aria-hidden="true"></div><div class="screw s4" aria-hidden="true"></div>

    <div class="glass">
      <div class="chart-wrap">
        <div class="dial">
          <canvas id="myChart" width="400" height="400"></canvas>
        </div>
      </div>

      <div class="controls" role="group">
        <div><h1 class="title">Relógio de jornada</h1><p class="sub">Intervalos 15 min • preenchido = tempo</p></div>
        <div style="display:flex;gap:10px">
          <button class="btn" id="refreshBtn">⟳ Refresh</button>
          <button class="btn secondary" id="toggleLegend">••</button>
        </div>
        <div style="display:flex;flex-direction:column;gap:8px">
          <a class="link-salario" href="/salario.html" target="_blank" rel="noopener">Ir para Salário</a>
          <div class="meta"><span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:var(--accent2)"></span><small>Concluído</small><span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:var(--accent1);margin-left:8px"></span><small>Atual</small></div>
        </div>
        <div style="margin-top:auto;font-size:11px;color:rgba(207,214,220,0.55)"><small>Design: anel com gradientes • mesma lógica intacta</small></div>
      </div>
    </div>
  </div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function(){

  var ctx = document.getElementById('myChart').getContext('2d');

  // helpers
  function pad(n){ return n<10?('0'+n):(''+n); }
  var nowDate = new Date();
  var nowLabel = pad(nowDate.getHours()) + ':' + pad(nowDate.getMinutes());

  // cria cores com gradiente para cada tipo
  function makeGradient(type){
    // linear vertical gradient
    var g = ctx.createLinearGradient(0,0,0,400);
    if(type==='completed'){
      g.addColorStop(0, '#004d2a'); g.addColorStop(1, '#00ff77');
    } else if(type==='current'){
      g.addColorStop(0, '#00bfcf'); g.addColorStop(1, '#66ffff');
    } else if(type==='future'){
      g.addColorStop(0, '#e6e6e6'); g.addColorStop(1, '#a9a9a9');
    } else { // fallback / default
      g.addColorStop(0, '#330000'); g.addColorStop(1, '#550000');
    }
    return g;
  }

  // inicializa dados e cores padrão (fallback burgundy)
  var labels = [
    '08:00','08:15','08:30','08:45','09:00','09:15','09:30','09:45','10:00','10:15','10:30','10:45',
    '11:00','11:15','11:30','11:45','12:00','12:15','12:30','12:45',
    '13:00','13:15','13:30','13:45','14:00','14:15','14:30','14:45',
    '15:00','15:15','15:30','15:45','16:00','16:15','16:30','16:45'
  ];
  var dataArr = new Array(36).fill(0);
  var bgArr = new Array(36).fill(makeGradient('default'));

  // preserva a mesma lógica funcional do seu script original
  var currentTime = new Date();
  var startWorkHour = 8;
  var endWorkHour = 17;
  var currentHour = currentTime.getHours();
  var currentMinute = currentTime.getMinutes();
  var timeElapsed = 0;

  if (currentHour < startWorkHour) {
    currentHour += 24;
  }

  var intervalsElapsed = 0;
  if (currentHour >= startWorkHour && currentHour <= endWorkHour) {
    timeElapsed = (currentHour - startWorkHour) * 60 + currentMinute;
    intervalsElapsed = Math.floor(timeElapsed / 15);

    // segmentos "futuros" (original fazia preencher com #dddddd)
    for (var i = intervalsElapsed + 1; i < 36; i++) {
      if (dataArr[i] !== undefined) {
        dataArr[i] = 1;
        bgArr[i] = makeGradient('future');
      }
    }
    // segmentos passados+atual
    for (var i = 0; i < intervalsElapsed; i++) {
      if(i == intervalsElapsed - 1) {
        bgArr[i] = makeGradient('current'); // último contado = atual (ciano)
      } else {
        bgArr[i] = makeGradient('completed'); // passado = verde
      }
      dataArr[i] = 1;
    }
  }

  // plugin para texto central e leve brilho interno
  Chart.pluginService.register({
    beforeDraw: function(chart){
      var width = chart.chart.width, height = chart.chart.height, ctx = chart.chart.ctx;
      ctx.restore();

      // brilho interno (sutil)
      ctx.save();
      ctx.globalCompositeOperation = 'lighter';
      var cx = width/2, cy = height/2;
      var grad = ctx.createRadialGradient(cx, cy, 0, cx, cy, Math.min(width,height)/2);
      grad.addColorStop(0, 'rgba(0,255,200,0.09)'); grad.addColorStop(0.6,'rgba(0,255,200,0.02)'); grad.addColorStop(1,'rgba(0,0,0,0)');
      ctx.fillStyle = grad;
      ctx.beginPath(); ctx.arc(cx, cy, Math.min(width,height)/2 * 0.62, 0, Math.PI*2); ctx.fill();
      ctx.restore();

      // central text (hora atual)
      ctx.save();
      ctx.fillStyle = '#dffcff';
      var fontSize = Math.round(height / 14);
      ctx.font = '600 ' + fontSize + 'px Inter, sans-serif';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText('"'+ nowLabel + '"', width/2, height/2 - 6);

      ctx.fillStyle = 'rgba(255,255,255,0.65)';
      ctx.font = '400 ' + Math.round(fontSize/2.5) + 'px Inter, sans-serif';
      ctx.fillText('Agora', width/2, height/2 + Math.round(fontSize/1.6));
      ctx.restore();
    }
  });

  // cria gráfico doughnut (anel) com borda sutil
  var myChart = new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: labels,
      datasets: [{
        data: dataArr,
        backgroundColor: bgArr,
        borderWidth: 2,
        borderColor: '#0b0c0f'
      }]
    },
    options: {
      cutoutPercentage: 68,
      rotation: -Math.PI / 2,
      circumference: Math.PI * 2,
      responsive: false,
      legend: { display: false },
      tooltips: { enabled: false },
      animation: { animateScale: true, animateRotate: true },
      elements: {
        arc: {
          borderAlign: 'inner'
        }
      }
    }
  });

  // botões (mesma funcionalidade)
  document.getElementById('refreshBtn').addEventListener('click', function(){ location.reload(); });
  document.getElementById('toggleLegend').addEventListener('click', function(){
    var dial = document.querySelector('.dial');
    dial.style.boxShadow = dial.style.boxShadow ? '' : 'inset 0 22px 44px rgba(0,255,200,0.02), 0 18px 36px rgba(0,255,120,0.02)';
  });

});
</script>
</body>
</html>
